---
title: "tmap"
author: "Ryan and Morgan"
date: "9/5/2019"
output: html_document
editor_options: 
  chunk_output_type: console
---
#NOT RUN
```{r setup, include=FALSE}
library(raster)
library(dplyr)
library(tidyr)
library(sf)
```


READ in all data
```{r}
ETH0 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_ETH_0_sp.rds")
ETH <-   readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_ETH_2_sp.rds")
ETH3 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_ETH_3_sp.rds")
DEM <- raster("/Users/ryankopper/Desktop/R work/PPTmap/gt30e020n40_dem/gt30e020n40.dem")
DEM2 <-raster("/Users/ryankopper/Desktop/R work/PPTmap/gt30e020s10_dem/gt30e020s10.dem")
ETH_dem <- mask(DEM, ETH0)

#ETHIOPIA studies
ETH_study_sites<-subset(ETH3,NAME_3 =="Adama" | NAME_3 =="Wondo-Genet" | NAME_3 == "Awasa Zuria"| NAME_3 =="Mieso" | NAME_3 == "Bako Tibe" | NAME_3 == "Jimma Arjo" | NAME_3 == "Boset"| NAME_3 == "Yayu" | NAME_3 == "Habro" | NAME_3 == "Tahtay Maychew" | NAME_3 == "Thehulederie") 

just_ETH <- st_as_sf(ETH_study_sites) %>% select(NAME_1)


```
Recreate using ggplot2 package
```{r}
library(dplyr)
library(ggplot2)
library(tidyr)
library(sf)
# convert spatial object to a ggplot ready data frame

pts_eth <- st_geometry(st_centroid(just_ETH))

pt_df <- as.data.frame(pts_eth, region = "id")

#NEED TO FIX THE COODINATES TO X AND Y VALUES
datf <- separate(pt_df, geometry, into = c("lon", "lat"), sep = ",")
datf$lon <- gsub("c\\(", "", datf$lon)
datf$lat <- gsub("\\)", "", datf$lat)

#plot points
ggplot() +
  geom_point(data = datf, aes(x = lon, y = lat )) +
  labs(title = "Plot locations")

#Make DEM
dem.p  <-  rasterToPoints(ETH_dem)
df <-  data.frame(dem.p)
colnames(df) = c("lon", "lat", "alt")

p1 <- ggplot(df, aes(lon,lat)) +
  geom_raster(aes(fill = alt))
  

#Make GADM file for ggplot

outline <- ggplot() + 
  geom_polygon(data=ETH0, aes(long,lat,group=group), fill="gray") +
  geom_path(data=ETH0, aes(long,lat, group=group), color="black",
            size=0.1) 
#   +
#   geom_point(data = datf, aes(x = x, y = y ))
# 
# # plot lines and points together----no working properly
# 
ggplot() +
  geom_point(data = datf, aes(x = lat, y = lon),
             pch = 20, size = 5, colour = "black") +
  geom_polygon(data = x,
               mapping = aes(x = long,
                           y = lat,
                           colour = "grey"),
               alpha = 0)

#----------------------------------------------------------------------------

#PLOTTING USING RASTER After converting the point files to dots ^
#must run code aove under the ggplot process.

plot(ETH)
plot(pts_eth, col = "red", pch = 20, add = T)

#Using
library(mapview)
 

mapview(pts_eth, col.regions = "black", color = "red", map.types = c("Stamen.TerrainBackground", "Esri.WorldStreetMap")) 

```


