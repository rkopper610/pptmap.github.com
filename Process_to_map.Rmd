---
title: "Process to map PPT study areas"
author: "Ryan and Morgan"
date: "8/30/2019"
output: html_document
editor_options: 
  chunk_output_type: console
---
prerequisites:
```{r}
library(raster)
library(dplyr)
library(sf)
library(tidyr)

```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#Regions (Run once in order to download)
#ETH0 <- getData(name = "GADM", country = "ETH", level = 0)
#ETH <- getData(name = "GADM", country = "ETH", level = 2)
#ETH3 <- getData(name = "GADM", country = "ETH", level = 3)
#KEN0 <- getData(name = "GADM", country = "KEN", level = 0)
#KEN2 <- getData(name = "GADM", country = "KEN", level = 2)
#KEN3 <- getData(name = "GADM", country = "KEN", level = 3)
#UGA0 <- getData(name = "GADM", country = "UGA", level = 0)
#UGA <- getData(name = "GADM", country = "UGA", level = 1)
#UGA3 <- getData(name = "GADM", country = "UGA", level = 3)
#TZA0 <- getData(name = "GADM", country = "TZA", level = 0)
#TZA <- getData(name = "GADM", country = "TZA", level = 2)

ETH0 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_ETH_0_sp.rds")
ETH <-   readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_ETH_2_sp.rds")
ETH3 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_ETH_3_sp.rds")

KEN0 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_KEN_0_sp.rds")
KEN2 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_KEN_2_sp.rds")
KEN3 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_KEN_3_sp.rds")

UGA <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_UGA_1_sp.rds")
UGA0 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_UGA_0_sp.rds")

TZA <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_TZA_2_sp.rds")
TZA0 <- readRDS("/Users/ryankopper/Desktop/R work/PPTmap/gadm36_TZA_0_sp.rds")

E_Af_No_b<- bind(ETH0, KEN0, UGA0, TZA0)

#E_Af<- bind(ETH3, KEN, UGA, TZA) map includes political internal boundaries
#E_Af <- aggregate(E_Af) #if needed to blend for analysis

#Kenya Study sites

KEN2_oneS <- subset(KEN2, NAME_2 == "Rarieda")


#Kenya study sites 2-5
KEN2_2TO5 <- subset(KEN3, NAME_2 =="Nyando" | NAME_2 == "Rongo" |
                        NAME_2=="Teso North"  )

KEN3_2TO5<-subset(KEN3, NAME_1=="Trans Nzoia"| NAME_1=="Kisumu" )


#Study sites with 5-10
KEN2_5to10 <-subset(KEN2,  NAME_2 == "Butere" |NAME_2 == "Bondo")
KEN3_5to10 <- subset(KEN, NAME_1=="Bungoma"| NAME_1=="Kisii")

#Butere-Mumias is now just Butere
#acounted for--Rachuonyo--is now part of Homa bay (rachuonyo +homa bay = 14)
#acounted for--Kuria became migori
#Alupe (in busia),
#Study sites with more than 10
KEN_10 <- subset(KEN,NAME_1=="Busia" | NAME_1 == "Migori"| NAME_1=="Homa Bay" | NAME_1=="Siaya")
KEN_10_oth <- subset(KEN,NAME_1=="Suba" | NAME_1=="Vihiga")



#------------------------------------------------------------------------------

# Uganda studies
UGA_sites<-subset(UGA,NAME_1 =="Tororo" | NAME_1 =="Bugiri"| 
                          NAME_1 == "Busia" | NAME_1 == "Pallisa")

#NAME_1 =="Iganga" MAY NOT NEED? 
                        
# Tanzania studies
TZA_study_sites <- subset(TZA, NAME_2 == "Sengerema"| NAME_2 == "Misungwi") #single study
TZA_3 <- subset(TZA, NAME_2 == "Tarime") #3studies/Blue 

#ETHIOPIA studies
ETH_study_sites<-subset(ETH3,NAME_3 =="Adama" | NAME_3 =="Wondo-Genet" | NAME_3 == "Awasa Zuria"| NAME_3 =="Mieso" | NAME_3 == "Bako Tibe" | NAME_3 == "Jimma Arjo" | NAME_3 == "Boset"| NAME_3 == "Yayu" | NAME_3 == "Habro" | NAME_3 == "Tahtay Maychew" | NAME_3 == "Thehulederie") 


#(study ID #9//#Melkassa = "adama")
#Tula (ID 25) "Tula" is also in Hawassa with awasa zuria and wondo-genet 
#Dore Bafano and Jara Gelelcha (ID 27)

#Plot 4 countries without political boders (level 0)
par(mar = c(0, 0, 1, 0 ))
plot(E_Af_No_b, col = "grey") 

legend(x = "bottomright", pch = 15, col = c("blue", "yellow", "orange", "red"),
       legend = c("one study", "2-5 studies", "5-10 studies", "10+ studies"), bty = "n", pt.cex = 2)



#Frequency mapping------

#One Study Occurance (Blue)
blue <- bind(ETH_study_sites, TZA_study_sites)
points(coordinates(blue),pch = 20, col = "blue") 

#2--5 study Occurance (Yellow) 
yellow <- bind(TZA_3, UGA_sites)
points(coordinates(yellow),pch = 20, col = "yellow")

#5--10 study Occurance (orange) 
orange <- bind(KEN2_5to10, KEN3_5to10)
points(coordinates(orange), pch = 20, col = "orange")

#10 + study Occurance (red)
red <- bind(KEN_10, KEN_10_oth)
points(coordinates(red), pch = 20, col = "red")




```

#Interative map with Mapview
```{r}

library(mapview)

mapview(KEN3)

#viewmap <-
mapview(E_Af_No_b, col.regions = "grey", color = "black", alpha = "0.9" , map.types = "Stamen.Toner") + mapView(KEN_study_sites, col.regions = "red",  color = "red") +
  mapView(UGA_sites, col.regions = "red", color = "red") + mapView(TZA_study_sites, col.regions = "red", color = "red") +
  mapView(ETH_study_sites, col.regions = "red", color = "red") + mapView(KEN2study_sites, col.regions = "purple", color = "purple")

# # Save a pdf of the map
# mapshot(viewmap, file = "map.pdf")

```


